<?xml version="1.0" ?>
<queries>
    <query_group group="Top 100">
        <query format="SSSSSSSSS" title="Top 100 most recent queries">
		SELECT a.time, a.user_name, a.search_word, a.gid_list, a.mode, a.query_type, a.search_time, a.server_time, a.client_time FROM ((SELECT * FROM LOGDB.search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; ORDER BY time DESC limit 100) UNION (SELECT * FROM LOGDB.part_search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; ORDER BY time DESC limit 100)) as a ORDER BY a.time DESC limit 100
	</query>
        <query format="SSSSSSSSS" title="Top 100 queries with highest search times">
		SELECT a.time, a.user_name, a.search_word, a.gid_list, a.mode, a.query_type, a.search_time, a.server_time, a.client_time FROM ((SELECT * FROM LOGDB.search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; ORDER BY search_time DESC limit 100) UNION (SELECT * FROM LOGDB.part_search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; ORDER BY search_time DESC limit 100)) as a ORDER BY a.search_time DESC limit 100 
	</query>
        <query format="SSSSSSSSS" title="Top 100 unique queries with highest search times">
		SELECT search_word, COUNT(*) as search_count, MIN(search_time) as min_search_time, MAX(search_time) as max_search_time, AVG(search_time) as avg_search_time FROM (select * from LOGDB.search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; UNION select * from LOGDB.part_search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; ) as temp_table GROUP BY search_word ORDER BY max_search_time DESC limit 100 
	</query>
        <query format="SSSSSSSSS" title="Top 100 most searched queries">
		SELECT search_word, COUNT(*) as search_count, MIN(search_time) as min_search_time, MAX(search_time) as max_search_time, AVG(search_time) as avg_search_time FROM (select * from LOGDB.search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; UNION select * from LOGDB.part_search_stats WHERE process_name like &quot;vtvsproxyd%%&quot; ) as temp_table GROUP BY search_word HAVING COUNT(*) &gt; 1 ORDER BY search_count DESC LIMIT 100 
	</query>
    </query_group>
    <query_group group="Per Hour SProxy Stats">
        <query format="SSSSS" title="Per Hour SPROXY Search Stats">
		select hour(time) as Hours, count(*) as Requests, min(search_time) as Min, max(search_time) as Max, sum(search_time)/count(*) as Average from LOGDB.search_stats where process_name like &quot;vtvsproxyd%%&quot; group by hour(time)     
	</query>
        <query format="SSSSS" title="Per Hour Per User SPROXY Search Stats">
		select s.user_name as User, u.user_agent as Agent, Hours, total as Requests, min_time as Min, max_time as Max, avg_time as Average from (select user_name, hour(time) as Hours, count(*) as total, min(search_time) as min_time, max(search_time) as max_time, sum(search_time)/count(*) as avg_time from LOGDB.search_stats where process_name like &quot;vtvsproxyd%%&quot; group by user_name, hour(time)) as s, (select distinct(user_name) as user_name, user_agent from LOGDB.user) as u where u.user_name = s.user_name 
	</query>
        <query format="SSSSS" title="Per Hour SPROXY Bucket Stats">
		select hour(time) as Hours, sum(requests) as Requests, cast(sum(len_1 * requests * 0.01) as UNSIGNED INTEGER) as  &quot;Length1&quot;, cast(sum(len_2 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Length2&quot;, cast(sum(len_3 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Length3&quot;, cast(sum(len_4 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Length4&quot;, cast(sum(len_5 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Length5&quot;, cast(sum(len_6 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Length6&quot;, cast(sum(len_6_g * requests * 0.01) as UNSIGNED INTEGER) as &quot;Lengthge6&quot;, cast(sum(words_1 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Words1&quot;, cast(sum(words_2 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Words2&quot;, cast(sum(words_3 * requests * 0.01) as UNSIGNED INTEGER) as &quot;Words3&quot;, cast(sum(words_3_g * requests * 0.01) as UNSIGNED INTEGER) as &quot;Wordsge3&quot; from LOGDB.bucket_stats where name = &quot;vtvsproxyd&quot; group by hour(time)   
	</query>
        <query format="SSSSS" title="Per Hour SPROXY Query Stats">
		select hour(time) as Hours, count(*) as Requests, query_type as Query from LOGDB.search_stats where process_name like &quot;vtvsproxyd%%&quot; group by query_type, hour(time)
	</query>
        <query format="SSSSS" title="Per Hour Per user SPROXY Query Stats">
		select s.user_name as User, u.user_agent as Agent, Hours, total as Requests, s.query_type as Query from (select user_name, hour(time) as Hours, count(*) as total, query_type from LOGDB.search_stats where process_name like &quot;vtvsproxyd%%&quot; group by user_name, hour(time)) as s, (select distinct(user_name) as user_name, user_agent from LOGDB.user) as u where u.user_name = s.user_name
	</query>
        <query format="SSSSS" title="Per Hour SPROXY Server Stats">
		select hour(time) as Hours, field as Name, sum(value) as Value from LOGDB.server_stats where stats_name=&quot;server_stats&quot; and process_name=&quot;SPROXYD&quot; and field in (&quot;number_of_requests&quot;, &quot;number_of_responses&quot;, &quot;total_responses_in_bytes&quot;,  &quot;total_requests_in_bytes&quot;) group by hour(time), field order by field, Hours  
	</query>
    </query_group>
    <query_group group="15 Minute Stats">
        <query format="SSS" title="15 mins requests process wise">
		select FROM_UNIXTIME(UNIX_TIMESTAMP(time) - MOD(UNIX_TIMESTAMP(time), 900)) as time, SUM(value) as request_count, process_name from LOGDB.server_stats where field=&quot;number_of_requests&quot; and stats_name=&quot;server_stats&quot; group by process_name, (UNIX_TIMESTAMP(time) - MOD(UNIX_TIMESTAMP(time), 900))  
	</query>
        <query format="SSS" title="Last 15 mins Query Type Stats">
		select query_type, count(*) as count, min(search_time) as MIN, max(search_time) as MAX, avg(search_time) as AVG from LOGDB.part_search_stats  where process_name like &quot;vtvsproxyd%%&quot; group by query_type   
	</query>
        <query format="SSS" title="15 mins per search server search stats">
		select process_name as Process, search_server_ip ServerIp, count(*) as Requests, min(search_time) as MIN, max(search_time) as MAX, avg(search_time) as AVG from LOGDB.part_search_stats  where process_name like &quot;vtvsearchd%%&quot; group by process_name, search_server_ip order by Requests desc  
	</query>
        <query format="SSS" title="Per 15 Minute Clients">
		select time, field, value from LOGDB.server_stats where process_name = &quot;SPROXYD&quot; and field in (&quot;number_of_clients&quot;, &quot;clients_processed&quot;, &quot;session_time&quot;) order by time desc  
	</query>
    </query_group>
</queries>
